From aa209330f4b6a7398356a4c262e61f7951bd7fde Mon Sep 17 00:00:00 2001
From: Satish Balay <balay@mcs.anl.gov>
Date: Fri, 7 Oct 2022 01:53:11 +0000
Subject: [PATCH] ptscotch: bison is required only for --download-ptscotch -
 not --with-ptscotch-lib etc..

Reported-by:  Lisandro Dalcin <dalcinl@gmail.com>
---
 config/BuildSystem/config/packages/PTScotch.py | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

diff --git a/config/BuildSystem/config/packages/PTScotch.py b/config/BuildSystem/config/packages/PTScotch.py
index 5a46e581fd2..57257519821 100644
--- a/config/BuildSystem/config/packages/PTScotch.py
+++ b/config/BuildSystem/config/packages/PTScotch.py
@@ -28,8 +28,8 @@ class Configure(config.package.Package):
     self.zlib           = framework.require('config.packages.zlib',self)
     self.regex          = framework.require('config.packages.regex',self)
     self.bison          = framework.require('config.packages.bison',self)
-    self.deps           = [self.mpi,self.mathlib,self.regex,self.bison]
-    self.odeps          = [self.pthread,self.zlib]
+    self.deps           = [self.mpi,self.mathlib,self.regex]
+    self.odeps          = [self.pthread,self.zlib,self.bison]
     return
 
   def Install(self):
@@ -37,7 +37,7 @@ class Configure(config.package.Package):
 
     self.programs.getExecutable('flex', getFullPath = 1)
     if not hasattr(self.programs, 'flex'): raise RuntimeError('PTScotch needs flex installed')
-    if not self.bison.haveBison3plus: raise RuntimeError('PTScotch needs Bison version 3.0 or above, use --download-bison')
+    if not self.bison.found or not self.bison.haveBison3plus: raise RuntimeError('PTScotch needs Bison version 3.0 or above, use --download-bison')
 
     self.log.write('Creating PTScotch '+os.path.join(os.path.join(self.packageDir,'src'),'Makefile.inc')+'\n')
 
-- 
2.37.3

